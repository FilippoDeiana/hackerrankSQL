SELECT W.ID, WP.AGE, W.COINS_NEEDED, W.POWER
FROM WANDS W
JOIN WANDS_PROPERTY WP
ON W.CODE = WP.CODE
WHERE WP.IS_EVIL = 0
AND W.COINS_NEEDED = (SELECT MIN(WA.COINS_NEEDED) FROM WANDS WA WHERE WA.CODE = W.CODE AND POWER = W.POWER)
ORDER BY W.POWER DESC, WP.AGE DESC;
